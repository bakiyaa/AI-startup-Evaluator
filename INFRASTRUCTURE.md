# Infrastructure and Configuration

This document outlines the necessary infrastructure to be created on Google Cloud Platform (GCP) and the configuration needed to run the AI Startup Evaluator application.

## GCP Infrastructure

As per `usecase1.md`, the following GCP services need to be set up:

1.  **Google Cloud Storage (GCS)**:
    *   A bucket to store the uploaded pitch decks and supporting documents.

2.  **Cloud Functions**:
    *   **`generateSignedUrl`**: An HTTP-triggered function that generates a signed URL for securely uploading files to the GCS bucket.
    *   **`processDocument`**: A GCS-triggered function that is invoked when a new file is uploaded to the bucket. This function will:
        *   Use **Cloud Vision AI** to extract text from PDF documents.
        *   Use **Speech-to-Text** to transcribe audio files (for call transcripts).
        *   Use the **Gemini API** to analyze the extracted text and generate deal notes.
        *   Store the generated notes in **Firestore**.

3.  **Firestore**:
    *   A NoSQL database to store the structured deal notes generated by the `processDocument` function.

4.  **Identity and Access Management (IAM)**:
    *   Service accounts with appropriate permissions for the Cloud Functions to access GCS, Vision AI, Speech-to-Text, Gemini, and Firestore.

## Credentials and Configuration

The following credentials and configuration values are needed to run the application. These should be stored in a `.env.local` file in the root of the React project.

```
# Firebase configuration for the React App
REACT_APP_API_KEY=your-firebase-api-key
REACT_APP_AUTH_DOMAIN=your-firebase-auth-domain
REACT_APP_PROJECT_ID=your-gcp-project-id
REACT_APP_STORAGE_BUCKET=your-gcs-bucket-name
REACT_APP_MESSAGING_SENDER_ID=your-firebase-messaging-sender-id
REACT_APP_APP_ID=your-firebase-app-id

# URL of the generateSignedUrl Cloud Function
REACT_APP_SIGNED_URL_FUNCTION_URL=https://us-central1-your-gcp-project-id.cloudfunctions.net/generateSignedUrl
```

### Obtaining Credentials

1.  **Firebase Configuration**:
    *   Go to the Firebase console: [https://console.firebase.google.com/](https://console.firebase.google.com/)
    *   Create a new project or use an existing one.
    *   In the project settings, under the "General" tab, you will find the Firebase configuration values.

2.  **GCP Project ID**:
    *   This is the ID of your Google Cloud project.

3.  **GCS Bucket Name**:
    *   Create a new bucket in Google Cloud Storage and note its name.

4.  **`generateSignedUrl` Function URL**:
    *   After deploying the `generateSignedUrl` Cloud Function, you will get a URL. This URL should be used for `REACT_APP_SIGNED_URL_FUNCTION_URL`.

### Cloud Function Environment Variables

When deploying the Cloud Functions, you will need to set the following environment variables:

*   **`generateSignedUrl` function**:
    *   `GCS_BUCKET_NAME`: The name of your Google Cloud Storage bucket.

*   **`processDocument` function**:
    *   `GCS_BUCKET_NAME`: The name of your Google Cloud Storage bucket.
    *   `FIRESTORE_COLLECTION_NAME`: The name of the Firestore collection to store the deal notes in (e.g., `deal-notes`).
    *   `GCP_PROJECT`: Your Google Cloud project ID.

### Service Account Credentials

The Cloud Functions will need service accounts with the following roles:

*   **`generateSignedUrl` function**:
    *   `Storage Object Creator` on the GCS bucket.
*   **`processDocument` function**:
    *   `Storage Object Viewer` on the GCS bucket.
    *   `Cloud Vision AI User`
    *   `Speech-to-Text User`
    *   `Vertex AI User` (for Gemini API)
    *   `Cloud Datastore User` (for Firestore)

You can create a service account in the "IAM & Admin" section of the GCP console and assign these roles to it. The Cloud Functions will use this service account to execute.
